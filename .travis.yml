language: cpp

os:
  - linux
  - osx

osx_image: xcode6.4

#jobs:
#  include:
#    - os: linux
#      dist: trusty
#    - os: osx
#      osx_image: xcode7.2

compiler:
  - gcc
  - clang

addons:
  apt:
    packages:
      - cppcheck
      - cmake
      - gcc-4.8

before_install:
  # install dependencies on osx
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; cd git clone https://github.com/sstephenson/bats.git && cd bats && ./install.sh /usr/local && cd ..; fi
  # install dependencies on linux
  #- if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo add-apt-repository ppa:duggan/bats --yes; fi
  #- if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get update -qq; fi
  #- if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install -qq bats; fi

script:
  - cmake CMakeLists.txt && make
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then cppcheck --enable=all ./src; fi

after_success:
  - ./bin/linux/ttt
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then ./test.sh; fi
